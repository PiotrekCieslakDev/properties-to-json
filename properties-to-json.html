<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Properties ‚Üí JSON</title>
    <style>
        :root {
            --bg: #ffffff;
            --text: #000000;
            --textarea-bg: #ffffff;
            --textarea-border: #bbb;
            --button-bg: #2d6cdf;
            --button-bg-hover: #1f4fb8;
        }

        body.dark {
            --bg: #0f172a;
            --text: #e2e8f0;
            --textarea-bg: #1e293b;
            --textarea-border: #475569;
            --button-bg: #4f46e5;
            --button-bg-hover: #6366f1;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background: var(--bg);
            color: var(--text);
            transition: background 0.3s, color 0.3s;
        }

        h1 { margin-bottom: 10px; }

        textarea {
            width: 100%;
            height: 220px;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid var(--textarea-border);
            font-family: monospace;
            font-size: 14px;
            resize: vertical;
            background: var(--textarea-bg);
            color: var(--text);
            transition: background 0.3s, color 0.3s, border 0.3s;
        }

        button {
            padding: 10px 16px;
            background: var(--button-bg);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
            transition: background 0.2s;
        }

        button:hover {
            background: var(--button-bg-hover);
        }

        #themeToggle {
            float: right;
            margin-top: -40px;
        }

        #output {
            margin-top: 20px;
        }
    </style>
</head>
<body>

<button id="themeToggle">üåô Dark mode</button>

<h1>Properties ‚Üí JSON</h1>
<p>Paste your .properties content below, click ‚ÄúConvert‚Äù, and the JSON output will appear below.</p>

<h3>Input (.properties)</h3>
<textarea id="propsInput" placeholder="spring.profiles.active=prod
#comment
jwt-access-expiration-ms=900000
jwt-refresh-expiration-ms=604800000"></textarea>

<button id="convertBtn">Convert</button>

<h3>Output (JSON)</h3>
<textarea id="output" readonly></textarea>

<script>
    // === ALGORITHM TRANSLATED 1:1 FROM THE PYTHON VERSION ===
    function propertiesToJson(propertiesText) {
        const result = {};
        const lines = propertiesText.split(/\r?\n/);

        for (let line of lines) {
            line = line.trim();

            // Skip empty lines, comments, and spring.profiles.active
            if (!line || line.startsWith("#") || line.startsWith("spring.profiles.active")) {
                continue;
            }

            let key, value;

            // Support "=" and ":"
            if (line.includes("=")) {
                [key, value] = line.split("=", 2);
            } else if (line.includes(":")) {
                [key, value] = line.split(":", 2);
            } else {
                continue;
            }

            key = key.trim();
            value = value.trim();

            // Remove surrounding quotes if present
            if (
                (value.startsWith('"') && value.endsWith('"')) ||
                (value.startsWith("'") && value.endsWith("'"))
            ) {
                value = value.substring(1, value.length - 1);
            }

            result[key] = value;
        }

        return JSON.stringify(result, null, 2);
    }

    // === Convert button logic ===
    document.getElementById("convertBtn").addEventListener("click", () => {
        const input = document.getElementById("propsInput").value;
        const json = propertiesToJson(input);
        document.getElementById("output").value = json;
    });

    // === Light/Dark theme toggle ===
    const themeToggle = document.getElementById("themeToggle");
    const body = document.body;

    function updateButtonText() {
        themeToggle.textContent = body.classList.contains("dark")
            ? "‚òÄÔ∏è Light mode"
            : "üåô Dark mode";
    }

    themeToggle.addEventListener("click", () => {
        body.classList.toggle("dark");
        localStorage.setItem("theme", body.className);
        updateButtonText();
    });

    // Load theme from localStorage
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme === "dark") {
        body.classList.add("dark");
    }

    updateButtonText();
</script>

</body>
</html>
